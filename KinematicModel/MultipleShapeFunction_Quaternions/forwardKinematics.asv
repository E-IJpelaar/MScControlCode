function dgdl = forwardKinematics(l,g,q,Ba,shape,Nmode)

Q = g(1:4);  % first end

%% Calculate strain field
[xi] = strainField(l,q,Ba,shape,Nmode);  % get strain field

K = xi(1:3);
T = xi(4:6);

QK = quat2rot(Q)*K;

A = [0   ,-QK(1),-QK(2),-QK(3);
     QK(1), 0   ,-QK(3), QK(2);
     QK(2), QK(3), 0   ,-QK(1);
     QK(3),-QK(2), QK(1),  0];
     
dQdl = (2*norm(Q))\(A*Q);
drdl = quat2rot(Q)*T;

dgdl = [dQdl;drdl];
    
     
     
